---
title: "WHO Manual on Administrative data"
output: 
  learnr::tutorial:
      theme: journal 
      toc: true
      toc_depth: 2
      toc_float:
        collapsed: false
        smooth_scroll: false
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
#https://bookdown.org/yihui/rmarkdown/html-document.html#table-of-contents
knitr::opts_chunk$set(echo = FALSE)
```

#Measuring the impact of new vaccines using mortality and administrative hospitalization data: Pneumococcal conjugate vaccine as a case study

## Introduction (Cris)
Once vaccines or other public health interventions are deployed, it is often desirable to measure their impact on health. This information is often critical for policy-makers who prioritize funding and implementation of different programs. However, conducting robust and credible evaluations of the public health impact of interventions is challenging. Real-world data are complex, and decisions about how to clean, format, analyze, and interpret the data can influence the conclusions about the impact of the intervention. 

In this manual, we present a framework for performing impact analyses using routinely-collected administrative data sources. As a specific case study, we discuss challenges in evaluating the impact of the introduction of pneumococcal conjugate vaccines among children on rates of hospitalization and death due to pneumonia. 

## Mortality data from Vital Statistics (Cris)

##	Hospitalization data from administrative sources (Cris)


## Study design (DAN) {.tabset .tabset-fade .tabset-pills}

### Overview
Observational studies present a number of analytical challenges. The introduction of vaccines is often occurring concurrently with other oublic health and social interventions that can influence disease rates. Other relevant changes include changes in social welfare systems, changes in the capacity of the healthcare system, changes in the efficincy of registering hospitalizations and deaths, and other pharmacological interventions that could influence susceptibility (e.g., increasing use of anti-retroviral therapy in sub-Saharan Africa).

###	Possible study designs for impact assessment

Given these factors, the analysis goal is to disentangle changes in disease rates that are caused by the introduction of a vaccine program with changes that are due to these other factors. There are several approaches that could be taken. First, in a *pre-licensure* study, vaccine impact could be evaluated using a cluster-randomized design, where disease rates are compared between clusters that have no vs high vaccine uptake (or between clsters that have varying levels of uptake). In a *post-licensure setting*, this type of design can be approximated by using a 'step-wedge' study design, where the vaccine is rolled out in phases in different geographic units, and the geographic units are randomized to receive the vaccine earlier or later. In this design, the geographic units that introduce the vaccine later serve as controls for the geographics units that introduce the vaccine earlier. 

In most settings, however, such controlled roll-outs of vaccine are not possible. Therefore, the most common study designs are purely observational in which changes in incidence are evaluated over time or in which geographic units are compared based on their levels of vaccine coverage. Extreme caution needs to be used when performing and interpreting these studies to ensure that factors unlreated to vaccination are appropriately adjusted in the analysis.  


###	Time series analysis
	Types of models for time series analysis

###	Controls – conventional vs synthetic control approach
	Describe each one, compare approaches, and 


##	Defining the study question and objectives (CRISTIANA)



##	Data Sources (international and national for both mortality and hospitalization) (Cristiana)


##	Feasibility of conducting a time series analysis of secondary data to assess vaccine impact (Concepts) (CRISTIANA)


## Data management (MOSTLY CRISTIANA)


## Data analysis (text + web based tutorial) (DAN)
###	Data formatting

To evaluate changes in disease rates associated with an intervention, the first step is to format the data into a **time series**. Time series enumerate the number of cases in a time period (e.g., week, month, quarter, or year). We typically do this by starting with a spreadsheet that has individual-level data, creating a variable that has the date rounded rown to the date of the beginning of the nearest week/month/quarter/year, and then adding up the number of cases that occurred during that time period. 

Ultimately we want to get a dataset that looks something like this, with a column for the date, and a column for each of the diseases that we want to enumerate
```{r, echo=F}
dataset<-cbind.data.frame( 'date'=seq.Date(from=as.Date('2010-01-01'), length.out=15, by='month'), 'pneumonia'=rpois(15, lambda=50), 'control1'=rpois(15, lambda=200))
print(dataset)
```

If you have multiple strata, such as different age groups or regions, the dataset will need to reflect this. In the table below, we have 3 age groups, each with 5 observations. Each date/age group combination should have only 1 row in this dataset.
```{r, echo=F}
dataset<-cbind.data.frame( 'age_group'= rep(1:3, each=5), 'date'=seq.Date(from=as.Date('2010-01-01'), length.out=5, by='month'), 'pneumonia'=rpois(15, lambda=50), 'control1'=rpois(15, lambda=200))
print(dataset)
```

In the *exercise*, we will learn how to take a individual-level dataset that has 1 observation for each hospitalization/death and convert it to a time series dataset.

-	Descriptive analysis
-	Time series models
- Synthetic Control analysis
-	Incorporating co-variates into the analyses
-	Exercises
#### Converting individual-level data to time series

## Interpreting results (DAN)
	‘dummy’ results that highlight different scenarios (ie wide Cis with a point estimate <<1, wide Cis with a point estimate near 1, tight Cis with a point estimate near 1, tight Cis with a point estimate far from 1)
o	Communicating and Presenting results effectively (including suggested templates) (DAN AND CRIS)
```{r}
#https://bookdown.org/yihui/rmarkdown/layout.html#story-boards
```


